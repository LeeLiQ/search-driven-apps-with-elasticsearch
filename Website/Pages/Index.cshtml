@page
@using Api
@using Website.Pages
@model Website.Pages.IndexModel
@{
  ViewData["Title"] = "Board Games, Yas!";
}

<div class="row">
  <h2>@Model.TotalCount games found</h2>
  @foreach (var game in Model.GamesToPlay)
  {
    <div class="col-md-4">
      <div class="game">
        <div class="bgg-id"><a href="@game.BoardGameGeekLink" title="Open on BoardGameGeek">#@game.Id</a></div>
        <div class="title">@game.Title</div>
        <div>
          <span class="player-counts">
            <span class="glyphicon glyphicon-user"></span>
            @{
              if (game.MinimumPlayers == game.MaximumPlayers)
              {
                @game.MinimumPlayers
              }
              else
              {
                @game.MinimumPlayers<text>-</text>@game.MaximumPlayers
                if (game.RecommendedPlayers > 0)
                {
                  <text> (</text>@game.RecommendedPlayers<text>)</text>
                }
              }
            }
          </span>
          <span class="rating"><span class="glyphicon glyphicon-thumbs-up"></span> <a href="@game.BoardGameGeekLink" title="Open on BoardGameGeek" target="_blank">@game.Rating</a></span>
        </div>
        <div class="time">
          <span class="glyphicon glyphicon-time"></span> @game.Time minutes
        </div>
        <div class="interested">
          <span class="glyphicon glyphicon-ok"></span>
          @{
            if (game.WantsToPlay != null && game.WantsToPlay.Any())
            {
              foreach (var w in game.WantsToPlay)
              {
                 <a href="?wantsToPlay=@w" title="Games that @w wants to play">@w</a>@((w != game.WantsToPlay.Last()) ? "," : "")
              }
            }
            else
            {
              <text>Nobody</text>
            }
          }
        </div>
        <div class="mechanics">
          <span class="glyphicon glyphicon-tags mechanics-icon"></span>
          @if (game.Mechanics.Where(x => x.Length > 0).Any()) // TODO!
          {
            foreach (var m in game.Mechanics)
            {
               <a href="/@m" target="_blank" title="Games with @m mechanics">@m</a>
               @((m != game.Mechanics.Last()) ? "," : "")
            }
          }
          else
          {
            <text>None</text>
          }
        </div>
      </div>
    </div>
  }
</div>

@if (@Model.ShowPagingToolbar)
{ 
  <div class="row">
    <div class="text-center">
      <nav aria-label="Page navigation">
        <ul class="pagination">
          @if (Model.CurrentPage > 1)
          {
            <li>
              <a href="?page=@(Model.CurrentPage - 1)" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
          }
          @for (var i = Model.PagingToolbarStart; i <= Model.PagingToolbarEnd; i++)
          {
            <li @if (Model.CurrentPage == i) { <text>class="active"</text> }>
              <a href="?page=@i">@i</a>
            </li>
          }
          @if (Model.PagingToolbarEnd < Model.TotalPages)
          {
            <li>
              <a href="?page=@(Model.CurrentPage + 1)" aria-label="Previous">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          }
        </ul>
      </nav>
    </div>
  </div>
}
